select *
     , sum(case when credit = $4 then $5 else $6 end) over() count_credit
     , sum($7) over() count_total
  from stmt.st_aoperation op
 where statement_id in ($1)
   and (deleted_at is null or deleted_at not in ($2))
   and coalesce(flag_over_price, $8) = $3
 order by oper_type DESC
 limit $9 offset $10;

select operation0_.id as id1_45_
	 , operation0_.accept_date as accept_d2_45_
	 , operation0_.accept_doc_date as accept_d3_45_
	 , operation0_.accept_doc_date_time as accept_d4_45_
	 , operation0_.accept_ground as accept_g5_45_
	 , operation0_.accept_number as accept_n6_45_
	 , operation0_.accept_oper_type as accept_o7_45_
	 , operation0_.accept_part_number as accept_p8_45_
	 , operation0_.accept_rest_amount as accept_r9_45_
	 , operation0_.account as account10_45_
	 , operation0_.account_cred as account11_45_
	 , operation0_.account_deb as account12_45_
	 , operation0_.statement_id as statem111_45_
	 , operation0_.amount as amount13_45_
	 , operation0_.amount_nat as amount_14_45_
	 , operation0_.bank_officials as bank_of15_45_
	 , operation0_.bic as bic16_45_
	 , operation0_.card2_date as card17_45_
	 , operation0_.card_amount as card_am18_45_
	 , operation0_.card_date as card_da19_45_
	 , operation0_.cash_amount_01 as cash_am20_45_
	 , operation0_.cash_amount_02 as cash_am21_45_
	 , operation0_.cash_amount_03 as cash_am22_45_
	 , operation0_.cash_amount_04 as cash_am23_45_
	 , operation0_.cash_amount_05 as cash_am24_45_
	 , operation0_.cash_document as cash_do25_45_
	 , operation0_.cash_free_field as cash_fr26_45_
	 , operation0_.cash_person as cash_pe27_45_
	 , operation0_.cash_person_doc as cash_pe28_45_
	 , operation0_.cash_symbol as cash_sy29_45_
	 , operation0_.cash_symbol_01 as cash_sy30_45_
	 , operation0_.cash_symbol_02 as cash_sy31_45_
	 , operation0_.cash_symbol_03 as cash_sy32_45_
	 , operation0_.cash_symbol_04 as cash_sy33_45_
	 , operation0_.cash_symbol_05 as cash_sy34_45_
	 , operation0_.cbc_code as cbc_cod35_45_
	 , operation0_.cheque_date as cheque_36_45_
	 , operation0_.cheque_num as cheque_37_45_
	 , operation0_.cheque_ser as cheque_38_45_
	 , operation0_.client as client39_45_
	 , operation0_.code_purpose as code_pu40_45_
	 , operation0_.code_uip as code_ui41_45_
	 , operation0_.corresp_account as corresp42_45_
	 , operation0_.credit as credit43_45_
	 , operation0_.curr_code as curr_co44_45_
	 , operation0_.deleted_at as deleted45_45_
	 , operation0_.doc_date_param as doc_dat46_45_
	 , operation0_.doc_num_param as doc_num47_45_
	 , operation0_.doc_ref as doc_ref48_45_
	 , operation0_.document_date as documen49_45_
	 , operation0_.document_number as documen50_45_
	 , operation0_.flag_i as flag_i51_45_
	 , operation0_.flag_notice_client_view as flag_no52_45_
	 , operation0_.flag_notification_client_view as flag_no53_45_
	 , operation0_.flag_over_price as flag_ov54_45_
	 , operation0_.flag_s as flag_s55_45_
	 , operation0_.flag_swift_client_view as flag_sw56_45_
	 , operation0_.flag_u as flag_u57_45_
	 , operation0_.ground as ground58_45_
	 , operation0_.init_ref as init_re59_45_
	 , operation0_.kb_op_id as kb_op_i60_45_
	 , operation0_.line_number as line_nu61_45_
	 , operation0_.mess_format as mess_fo62_45_
	 , operation0_.message_date as message63_45_
	 , operation0_.normalized_doc_date as normali64_45_
	 , operation0_.note_from_bank as note_fr65_45_
	 , operation0_.okato_code as okato_c66_45_
	 , operation0_.oper_type as oper_ty67_45_
	 , operation0_.order_payer as order_p68_45_
	 , operation0_.order_payer_account as order_p69_45_
	 , operation0_.order_receiver as order_r70_45_
	 , operation0_.order_receiver_account as order_r71_45_
	 , operation0_.parent_ref as parent_72_45_
	 , operation0_.pay_grnd_param as pay_grn73_45_
	 , operation0_.pay_type_param as pay_typ74_45_
	 , operation0_.pay_until as pay_unt75_45_
	 , operation0_.payer as payer76_45_
	 , operation0_.payer_account as payer_a77_45_
	 , operation0_.payer_bank_address as payer_b78_45_
	 , operation0_.payer_bank_name as payer_b79_45_
	 , operation0_.payer_bank_type as payer_b80_45_
	 , operation0_.payer_bic as payer_b81_45_
	 , operation0_.payer_corr_account as payer_c82_45_
	 , operation0_.payer_inn as payer_i83_45_
	 , operation0_.payer_kpp as payer_k84_45_
	 , operation0_.payer_place as payer_p85_45_
	 , operation0_.payer_place_type as payer_p86_45_
	 , operation0_.payer_property_type as payer_p87_45_
	 , operation0_.payment_req_accept as payment88_45_
	 , operation0_.payment_req_accept_date as payment89_45_
	 , operation0_.payment_req_conditions as payment90_45_
	 , operation0_.payment_urgent as payment91_45_
	 , operation0_.przo as przo92_45_
	 , operation0_.receipt_date_collect_bank as receipt93_45_
	 , operation0_.receiver as receive94_45_
	 , operation0_.receiver_account as receive95_45_
	 , operation0_.receiver_bank_address as receive96_45_
	 , operation0_.receiver_bank_name as receive97_45_
	 , operation0_.receiver_bank_type as receive98_45_
	 , operation0_.receiver_bic as receive99_45_
	 , operation0_.receiver_corr_account as receiv100_45_
	 , operation0_.receiver_inn as receiv101_45_
	 , operation0_.receiver_kpp as receiv102_45_
	 , operation0_.receiver_place as receiv103_45_
	 , operation0_.receiver_place_type as receiv104_45_
	 , operation0_.receiver_property_type as receiv105_45_
	 , operation0_.res_field as res_fi106_45_
	 , operation0_.saved_doc_ref as saved_107_45_
	 , operation0_.send_type as send_t108_45_
	 , operation0_.stat1256 as stat109_45_
	 , operation0_.statement_date as statem110_45_
	 , operation0_.swift_message as swift_112_45_
	 , operation0_.tax_period_param as tax_pe113_45_
	 , operation0_.value_date as value_114_45_
	 , operation0_.view_flags as view_f115_45_
  from stmt.st_aoperation operation0_
 where (operation0_.deleted_at is null)
   and (operation0_.statement_id in ($1))
   and (operation0_.oper_type in ($2 , $3 , $4))
 order by operation0_.id asc
 limit $5
offset $6;